package me.sevj6.listeners.patches;

import me.sevj6.Instance;
import me.sevj6.util.MessageUtil;
import me.sevj6.util.Utils;
import org.bukkit.Location;
import org.bukkit.Material;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.block.BlockDispenseEvent;

import java.util.Arrays;
import java.util.List;

/**
 * @author SevJ6
 */

public class DispenserExploits implements Listener, Instance {

    private final List<Material> throwables = Arrays.asList(Material.SNOW_BALL, Material.EXP_BOTTLE, Material.FIREBALL);

    @EventHandler
    public void onBlockDispense(BlockDispenseEvent event) {
        Location location = event.getBlock().getLocation();
        if (checkY(location)) {
            event.setCancelled(true);
            MessageUtil.log("&3Prevented a dispenser crash &r" + Utils.formatLocation(location));
            return;
        }
        if (throwables.contains(event.getItem().getType())) event.setCancelled(true);
    }

    private boolean checkY(Location location) {
        return (location.getY() < 1 || location.getY() >= 254);
    }
}
